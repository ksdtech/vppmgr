{{response.subtitle = 'Provision Apps'}}
{{extend 'layout.html'}}

<!-- jquery script and styles to move between two select lists -->
<script language="javascript" type="text/javascript" src="{{=URL('static','js/jquery.twosidedmultiselect.js')}}"></script>
<style>
.tsmsselect {
  width: 40%;
  float: left;
}
.tsmsselect select {
  width: 100%;
}
.tsmsoptions {
  width: 20%;
  float: left;
}
.tsmsoptions p {
  border: 1px solid #ccc;
  margin: 4px 10px 4px 10px;
  padding: 4px;
  text-align: center;
  cursor: pointer;
}
.tsmsoptions p:hover {
  color: White;
  background-color: Silver;
}
</style>
{{if group is not None:}}
<h3>Provision Apps Filtered by Group '{{=group_name}}'</h3>
{{else:}}
<h3>Provision Apps</h3>
{{pass}}

<form class="sel_form" method="POST">
<div>Instructions: Enter the user for whom
  app codes and download links will be provisioned,
	then check off the apps to be provisioned.
</div>
<h5>Filter by Groups</h5>
<div>To show only the apps for a particular group, click the link with
the group name.
<ul>
{{for i, g in enumerate(groups):}}
	<li><a href="{{=URL(f='provision', vars={'group': g.id})}}">{{=g.name}}</a></li>
{{pass}}
  <li><a href="{{=URL('provision')}}">List All</a></li>
</ul>
</div>
  <h5>User</h5>
  <div>Type user name or email address.<br />
    <input type="text" name="user_email" id="user_email" size="80" />
  </div>
  <h5>Devices</h5>
  <p>Move device(s) to selected list with Add and Remove buttons.<br />
    <select class="multiselect" name="device" id="device" multiple="multiple" size="12">
{{for d in devices:}}
	    <option value="{{=d.id}}">{{=d.name}}</option>
{{pass}}
	  </select>
    <div style="clear: both;">
  </div>
  <h5>Apps</h5>
  <div>Check apps to provision.<br />
  <table>
    <tr><td><input type="checkbox" class="appcheck" name="check_all" onclick="jQuery('.appcheck').attr('checked', 'checked')" />&nbsp;Check All</td></tr>
		<tr><td><input type="checkbox" class="appcheck" name="check_none" onclick="jQuery('.appcheck').removeAttr('checked');" />&nbsp;Check None</td></tr>
{{for i, ss in enumerate(apps):}}
		<tr class="{{='odd' if i%2 else 'even'}}">
			<td><input type="checkbox" class="appcheck" name="{{='app_%d' % apps[i].id}}" value="1" />&nbsp;{{=apps[i].name}}, {{=apps[i].price}}</td>
		</tr>
{{pass}}
    <tr><td><input type="submit" name="submit" value="Submit" /></td></tr>
	</table>
	</div>
</form>

<script language="javascript" type="text/javascript">
  $(".multiselect").twosidedmultiselect();
</script>
